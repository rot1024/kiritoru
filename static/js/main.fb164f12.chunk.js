(this.webpackJsonpkiritoru=this.webpackJsonpkiritoru||[]).push([[0],{11:function(e,t,n){e.exports=n(19)},16:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(6),o=n.n(c),i=(n(16),n(7)),u=n(3),s=n.n(u),f=n(8),l=n(2),b=n(9),g=n(1),d=n(4),p=n(10),h=n.n(p),j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200;if(e){var r=e.getContext("2d");if(r){var a=r.getImageData(0,0,e.width,e.height),c=r.getImageData(0,0,e.width,e.height);O(a),O(c),v(c),w(c,t),m(a,c),k(a,n),r.clearRect(0,0,e.width,e.height),r.putImageData(a,0,0,0,0,e.width,e.height)}}},O=function(e){for(var t=0;t<Math.floor(e.data.length/4);t++){var n=e.data[4*t],r=e.data[4*t+1],a=e.data[4*t+2],c=(Math.max(n,r,a)+Math.min(n,r,a))/2;e.data[4*t]=e.data[4*t+1]=e.data[4*t+2]=c}},v=function(e){for(var t=0;t<Math.floor(e.data.length/4);t++)e.data[4*t]=255-e.data[4*t],e.data[4*t+1]=255-e.data[4*t+1],e.data[4*t+2]=255-e.data[4*t+2]},w=function(e,t){h()(e.data,e.width,e.height,t)},m=function(e,t){for(var n=0;n<Math.floor(e.data.length/4);n++){var r=e.data[4*n]/255,a=t.data[4*n]/255,c=1===a?1:r/(1-a);e.data[4*n]=e.data[4*n+1]=e.data[4*n+2]=255*Math.min(1,c)}},k=function(e,t){for(var n=t/255,r=1-n,a=0;a<Math.floor(e.data.length/4);a++){var c=e.data[4*a]/255,o=0===n?1===c?1:0:c<=n?0:(c-n)/r;e.data[4*a]=e.data[4*a+1]=e.data[4*a+2]=255*o}},y=n(22);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(n,!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=function(e,t,n){return new Promise((function(r){e.toBlob(r,t,n)}))},E=function(){var e=Object(r.useRef)(null),t=Object(r.useRef)(""),n=Object(r.useMemo)((function(){return document.createElement("canvas")}),[]),c=Object(r.useRef)(!1),o=Object(y.a)("kiritoru_config",{jpg:!1,senga:!1}),i=Object(l.a)(o,2),u=i[0],p=i[1],h=Object(r.useState)(),O=Object(l.a)(h,2),v=O[0],w=O[1],m=Object(r.useCallback)((function(e){e&&0===e.type.indexOf("video/")&&(c.current=!1,t.current=e.name.replace(/\..+$/,""),w(URL.createObjectURL(e)))}),[]),k=Object(b.a)((function(e){m(e[0])})),x=Object(r.useCallback)((function(){e.current&&(c.current?e.current.pause():e.current.play(),c.current=!c.current)}),[]),E=Object(r.useCallback)((function(t){e.current&&(e.current.currentTime=e.current.currentTime+1/24*(t?1:-1))}),[]),T=Object(r.useCallback)((function(t){e.current&&(e.current.currentTime=e.current.currentTime+t)}),[]),D=Object(r.useCallback)((function(){if(!c.current)return E(!0)}),[E]),M=Object(r.useCallback)((function(){c.current||E(!1)}),[E]),R=Object(r.useCallback)((function(){return T(1)}),[T]),S=Object(r.useCallback)((function(){return T(-1)}),[T]),W=Object(r.useCallback)((function(){return T(10)}),[T]),A=Object(r.useCallback)((function(){return T(-10)}),[T]),I=Object(r.useCallback)(Object(f.a)(s.a.mark((function r(){var a,c,o,i;return s.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.current&&v){r.next=2;break}return r.abrupt("return");case 2:if(a=n.getContext("2d")){r.next=5;break}return r.abrupt("return");case 5:return n.width=e.current.videoWidth,n.height=e.current.videoHeight,a.drawImage(e.current,0,0),c="".concat(t.current,"_").concat(Math.floor(24*e.current.currentTime)),r.next=11,P(n,u.jpg?"image/jpeg":"image/png",.5);case 11:if((o=r.sent)&&e.current){r.next=14;break}return r.abrupt("return");case 14:if(Object(d.saveAs)(o,"".concat(c,".").concat(u.jpg?"jpg":"png")),!u.senga){r.next=23;break}return j(n),r.next=19,P(n,u.jpg?"image/jpeg":"image/png",1);case 19:if((i=r.sent)&&e.current){r.next=22;break}return r.abrupt("return");case 22:Object(d.saveAs)(i,"".concat(c,"_senga.").concat(u.jpg?"jpg":"png"));case 23:case"end":return r.stop()}}),r)}))),[n,u.jpg,u.senga,v]);Object(g.a)("space",x,[x]),Object(g.a)("o",k,[k]),Object(g.a)("left",M,[M]),Object(g.a)("right",D,[D]),Object(g.a)("shift+left",S,[S]),Object(g.a)("shift+right",R,[R]),Object(g.a)("alt+left",A,[A]),Object(g.a)("alt+right",W,[W]),Object(g.a)("c",I,[I]),Object(g.a)("t",(function(){p((function(e){return C({},e,{jpg:!e.jpg})}))}),[]),Object(g.a)("s",(function(){p((function(e){return C({},e,{senga:!e.senga})}))}),[]);var U=Object(r.useState)(!1),L=Object(l.a)(U,2),B=L[0],J=L[1];Object(r.useEffect)((function(){J(!0),G(!1);var e=window.setTimeout((function(){J(!1)}),1e3);return function(){return window.clearTimeout(e)}}),[u.jpg]);var N=Object(r.useState)(!1),_=Object(l.a)(N,2),F=_[0],G=_[1];Object(r.useEffect)((function(){J(!1),G(!0);var e=window.setTimeout((function(){G(!1)}),1e3);return function(){return window.clearTimeout(e)}}),[u.senga]);var $=Object(r.useCallback)((function(e){e.preventDefault(),m(e.dataTransfer.files[0])}),[m]),z=Object(r.useCallback)((function(e){e.preventDefault()}),[]);return a.a.createElement(a.a.Fragment,null,a.a.createElement("video",{ref:e,src:v,onClick:function(e){return e.currentTarget.blur()},onPlay:function(){c.current=!0},onPause:function(){c.current=!1},controls:!0,style:{width:"100%",height:"100%",background:"#000",objectFit:"contain"},onDragOver:z,onDrop:$}),a.a.createElement("div",{style:{position:"absolute",top:"10px",left:"10px",fontSize:"48px",color:"#fff",background:"rgba(0, 0, 0, 0.5)",pointerEvents:"none",padding:"0px 10px",opacity:B||F?"1":"0"}},F?u.senga?"\u7dda\u753b\u4fdd\u5b58":"\u7dda\u753b\u7121\u3057":u.jpg?"JPG":"PNG"))},T=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function D(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(a.a.createElement(E,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/kiritoru",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/kiritoru","/service-worker.js");T?(!function(e,t){fetch(e).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):D(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):D(t,e)}))}}()}},[[11,1,2]]]);
//# sourceMappingURL=main.fb164f12.chunk.js.map