(this.webpackJsonpkiritoru=this.webpackJsonpkiritoru||[]).push([[0],{11:function(t,e,n){t.exports=n(19)},16:function(t,e,n){},19:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),c=n(6),o=n.n(c),i=(n(16),n(7)),u=n(3),s=n.n(u),f=n(8),l=n(2),g=n(9),d=n(1),b=n(4),p=n(10),h=n.n(p),j=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:150;if(t){var r=t.getContext("2d");if(r){var a=r.getImageData(0,0,t.width,t.height),c=r.getImageData(0,0,t.width,t.height);v(a),v(c),O(c),w(c,e),m(a,c),k(a,n),r.clearRect(0,0,t.width,t.height),r.putImageData(a,0,0,0,0,t.width,t.height)}}},v=function(t){for(var e=0;e<Math.floor(t.data.length/4);e++){var n=t.data[4*e],r=t.data[4*e+1],a=t.data[4*e+2],c=(Math.max(n,r,a)+Math.min(n,r,a))/2;t.data[4*e]=t.data[4*e+1]=t.data[4*e+2]=c}},O=function(t){for(var e=0;e<Math.floor(t.data.length/4);e++)t.data[4*e]=255-t.data[4*e],t.data[4*e+1]=255-t.data[4*e+1],t.data[4*e+2]=255-t.data[4*e+2]},w=function(t,e){h()(t.data,t.width,t.height,e)},m=function(t,e){for(var n=0;n<Math.floor(t.data.length/4);n++){var r=t.data[4*n]/255,a=e.data[4*n]/255,c=1===a?1:r/(1-a);t.data[4*n]=t.data[4*n+1]=t.data[4*n+2]=255*Math.min(1,c)}},k=function(t,e){for(var n=e/255,r=1-n,a=0;a<Math.floor(t.data.length/4);a++){var c=t.data[4*a]/255,o=0===n?1===c?1:0:c<=n?0:(c-n)/r;t.data[4*a]=t.data[4*a+1]=t.data[4*a+2]=255*o}},y=n(22);function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(n,!0).forEach((function(e){Object(i.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C=function(t,e,n){return new Promise((function(r){t.toBlob(r,e,n)}))},E=function(){var t=Object(r.useRef)(null),e=Object(r.useRef)(""),n=Object(r.useMemo)((function(){return document.createElement("canvas")}),[]),c=Object(r.useRef)(!1),o=Object(y.a)("kiritoru_config",{jpg:!1,senga:!1}),i=Object(l.a)(o,2),u=i[0],p=i[1],h=Object(r.useState)(),v=Object(l.a)(h,2),O=v[0],w=v[1],m=Object(g.a)((function(t){c.current=!1,e.current=t[0].name.replace(/\..+$/,""),w(URL.createObjectURL(t[0]))})),k=Object(r.useCallback)((function(){t.current&&(c.current?t.current.pause():t.current.play(),c.current=!c.current)}),[]),x=Object(r.useCallback)((function(e){t.current&&(t.current.currentTime=t.current.currentTime+1/24*(e?1:-1))}),[]),E=Object(r.useCallback)((function(e){t.current&&(t.current.currentTime=t.current.currentTime+e)}),[]),T=Object(r.useCallback)((function(){return x(!0)}),[x]),M=Object(r.useCallback)((function(){return x(!1)}),[x]),R=Object(r.useCallback)((function(){return E(1)}),[E]),S=Object(r.useCallback)((function(){return E(-1)}),[E]),W=Object(r.useCallback)(Object(f.a)(s.a.mark((function r(){var a,c,o,i;return s.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.current&&O){r.next=2;break}return r.abrupt("return");case 2:if(a=n.getContext("2d")){r.next=5;break}return r.abrupt("return");case 5:return n.width=t.current.videoWidth,n.height=t.current.videoHeight,a.drawImage(t.current,0,0),c="".concat(e.current,"_").concat(Math.floor(24*t.current.currentTime)),r.next=11,C(n,u.jpg?"image/jpeg":"image/png",1);case 11:if((o=r.sent)&&t.current){r.next=14;break}return r.abrupt("return");case 14:if(Object(b.saveAs)(o,"".concat(c,".").concat(u.jpg?"jpg":"png")),!u.senga){r.next=23;break}return j(n),r.next=19,C(n,u.jpg?"image/jpeg":"image/png",1);case 19:if((i=r.sent)&&t.current){r.next=22;break}return r.abrupt("return");case 22:Object(b.saveAs)(i,"".concat(c,"_senga.").concat(u.jpg?"jpg":"png"));case 23:case"end":return r.stop()}}),r)}))),[n,u.jpg,u.senga,O]);Object(d.a)("space",k,[k]),Object(d.a)("o",m,[m]),Object(d.a)("left",M,[M]),Object(d.a)("right",T,[T]),Object(d.a)("shift+left",S,[S]),Object(d.a)("shift+right",R,[R]),Object(d.a)("c",W,[W]),Object(d.a)("t",(function(){p((function(t){return P({},t,{jpg:!t.jpg})}))}),[]),Object(d.a)("s",(function(){p((function(t){return P({},t,{senga:!t.senga})}))}),[]);var A=Object(r.useState)(!1),D=Object(l.a)(A,2),I=D[0],U=D[1];Object(r.useEffect)((function(){U(!0),N(!1);var t=window.setTimeout((function(){U(!1)}),1e3);return function(){return window.clearTimeout(t)}}),[u.jpg]);var L=Object(r.useState)(!1),B=Object(l.a)(L,2),J=B[0],N=B[1];return Object(r.useEffect)((function(){U(!1),N(!0);var t=window.setTimeout((function(){N(!1)}),1e3);return function(){return window.clearTimeout(t)}}),[u.senga]),a.a.createElement(a.a.Fragment,null,a.a.createElement("video",{ref:t,src:O,onClick:function(t){return t.currentTarget.blur()},onPlay:function(){c.current=!0},onPause:function(){c.current=!1},controls:!0,style:{width:"100%",height:"100%",background:"#000",objectFit:"contain"}}),a.a.createElement("div",{style:{position:"absolute",top:"10px",left:"10px",fontSize:"48px",color:"#fff",background:"rgba(0, 0, 0, 0.5)",pointerEvents:"none",padding:"0px 10px",opacity:I||J?"1":"0"}},J?u.senga?"\u7dda\u753b\u4fdd\u5b58":"\u7dda\u753b\u7121\u3057":u.jpg?"JPG":"PNG"))},T=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function M(t,e){navigator.serviceWorker.register(t).then((function(t){t.onupdatefound=function(){var n=t.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),e&&e.onUpdate&&e.onUpdate(t)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(t)))})}})).catch((function(t){console.error("Error during service worker registration:",t)}))}o.a.render(a.a.createElement(E,null),document.getElementById("root")),function(t){if("serviceWorker"in navigator){if(new URL("/kiritoru",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/kiritoru","/service-worker.js");T?(!function(t,e){fetch(t).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(t){t.unregister().then((function(){window.location.reload()}))})):M(t,e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e,t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):M(e,t)}))}}()}},[[11,1,2]]]);
//# sourceMappingURL=main.38ced5c4.chunk.js.map